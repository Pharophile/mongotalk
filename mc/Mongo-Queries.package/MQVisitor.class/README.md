A visitor to build queries